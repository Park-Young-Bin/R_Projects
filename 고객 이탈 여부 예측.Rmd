---
title: "고객 이탈 여부 예측"
author: "PYB"
date: '2021 2 11 '
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## **고객 이탈 여부 예측 분석**

#### [분석문제]

ABC 이동 통신사에서 고객들의 개인정보를 통해 고객들의 통신사 이탈 여부에 대해 예측하려고 한다. 다시 말해서 어떤 요인들이 통신사 이탈여부에  영향을 주는지 분석해 보는 것이다.

1. 의미 있다고 판단되는 독립변수와 종속변수를 선정하여 상호인과성을 파악하고, 회귀식을 도출하라.

종속변수 1개에 독립변수가 여러 개 이고, 변수 간의 인과관계를 통계적으로 추론하는 방법인 **'다중회귀분석'**을 이용한다.

### 1. 실습 데이터 불러오기 및 읽기
```{r}
inf <- read.csv("C:/Users/user/Desktop/R/Practice/ubion/mytelecom.csv", header = T)
head(inf, 10)
tail(inf)
str(inf)
summary(inf)
```

### 2. 다중회귀분석(단계적 회귀분석)
독립변수는 tenure, age, income, gender, reside로 설정한다. 그리고 다중회귀분석에서 변수 선택 방법은 **"단계적 회귀분석"**을 이용한다. 독립변수가 많을수록 회귀분석의 적합도인 R2값은 떨어지게 된다. 만약 독립변수가 30개라면, 다중회귀분석에서 30개 변수 모두를 투입하고 종속변수와의 영향력을 보게 된다.  
문제는 이렇게 많은 변수를 투입하면 모델의 설명력이 떨어지거나 변수들간의 관계 때문에 가설이 모두 기각되는 경우가 발생한다. 이러한 경우 투입한 변수를 순차적으로 모형에 투입하여 종속변수에 영향력을 미치는 최소 변수들만을 남기는 기법이 "단계적 회귀분석"이다.  

#### [요약]
* 설명력이 높은(p-값이 가장 작은) 변수의 순서로 회귀식에 포함
* 전 단계에서 회귀식에 포함된 독립변수들도 나중에 들어오는 변수 때문에 설명력이 매우 낮아지면 회귀식에서 제거
* 종속변수를 설명하는 데에 있어서 설명력이 어느 정도 이상되는 변수들로만 구성된 회귀식을 발견하는 데에 유용
```{r}
summary(step(lm(churn ~ tenure + age + income + gender + reside, inf)))
```
[결과]

* 첫 번째 행을 살펴보면 인자로 주어진 모델 churn은 tenure, age, income, gender, reside 변수를 사용하고 있다. 그리고 그때 AIC 값은 -1764.55였다. 그 뒤에 나열된 결과는 각 변수를 삭제했을 때(‘- 설명 변수명’ 형식으로 각 행이 표시됨) AIC의 변화를 표현하고 있다. 예를 들어, gender 변수가 제거된 경우 AIC는 -1766.4이고, income 변수가 제거되었을 때 AIC는 -1766.1이었다. AIC는 작을수록 더 좋은 모델을 뜻하므로 AIC를 가장 작게 만드는 gender 변수만 이 단계에서 제거된다. 이와 같은 변수의 추가와 삭제를 반복한다.

* step()에서는 AIC 값이 작아지다가 더 이상 작아지지 않는 모형이 최종적으로 선택된 모형이 된다. 여기서는 네 번째 회귀모형이 최종 모형이 된다.
  - churn에 영향을 미치는 독립변수로 tenure과 age가 선택되었다.
  - 참고로 step()은 매 스텝마다 후진과 전진을 수행하면서 AIC 값이 가장 작은 쪽인 모형을 선택 한다. 더 이상 AIC값을 줄일 수 없으면 stop한다.

[가설]

1. 회귀모형의 유의미성  
H0: 회귀모형은 통계적으로 유의하지 않다.   H1: 회귀모형은 통계적으로 유의하다.  
F-통계량이 86.66이고, p-값이 2.2e-16로 유의수준 0.05보다 작으므로 귀무가설을 기각하여 회귀모형은 유의하다고 할 수 있다.  
1. 회귀계수의 유의미성  
H0: 회귀계수는 통계적으로 유의하지 않다.   H1: 회귀계수는 통계적으로 유의하다.  
tenure, age 두 변수의 p-값이 모두 유의수준 0.05보다 작으므로 귀무가설을 기각한다. 따라서 회귀계수는 유의하다고 할 수 있다. 그리고 tenure의 회귀계수는 -0.0069545, age의 회귀계수는 -0.0031847이다. y절편은 0.6538150이다.
1. 모형의 설명력
다중회귀계수의 경우 설명력은 Adjusted R-squared(수정된 설명계수)를 확인한다.  
0.1464이므로 14.64%의 설명력을 갖는다고 할 수 있다.

따라서 추정된 회귀선은 churn = 0.6538150 -0.0069545 * tenure -0.0031847 * age 이다.  